<% var img_path='/assets/images/'; %>

<footer class="l-footer">
  <small class="c-footer__copyright">&copy;Shoya Baba.All Rights Reserved 2020.</small>
  <div class="l-footer__container">
    <ul class="c-footer__contact">
      <% var footer_hover_text=['Twitter', 'GitHub', 'Qiita']; %>
      <% var footer_link=["https://twitter.com/babi_0105", "https://github.com/baby-0105", "https://qiita.com/baby-0105"] %>
      <% var footer_contact=["fab fa-twitter", "fab fa-github-alt"]; %> <!-- "far fa-envelope": メールアイコン -->
      <% for (var i=0; i < footer_contact.length; i++) { %>
        <li class="c-footer__contactList">
          <a class="c-footer__contactLink" href="<%= footer_link[i] %>" target="_blank">
            <p class="c-footer__contact__hoverText"><%= footer_hover_text[i] %></p>
            <i class="<%= footer_contact[i] %>"></i>
          </a>
        </li>
      <% } %>

      <li class="c-footer__contactList">
        <a class="c-footer__contactLink" href="<%= footer_link[2] %>" target="_blank">
          <p class="c-footer__contact__hoverIcon"><%= footer_hover_text[2] %></p>
        </a>
      </li>
    </ul>
  </div>
</footer>

</div><!-- l-wrap -->
<script>
  {
    const $bodyAndHtml = $('body, html'),
          $body = $('body');

    let scrollPosi;
        lowerTitle=['intro', 'skills', 'production', 'canDo', 'contact'],
        upperTitle=['Intro', 'Skills', 'Production', 'CanDo', 'Contact'];

    // ページの一番上までスクロールさせます。
    $("#to_top").on('click', function() {
      $bodyAndHtml.animate({scrollTop: 0}, 300, 'linear');
    });

    // SP用：ハンバーガーのトグルアクション
    $(document).on('click', function(e) {
      const $headerNav = $('#headerNav')

      if($(e.target).is('#hamburger')) {
        $headerNav.toggleClass('c-header__is-active');
      } else if($(e.target).is('*')) {
        $headerNav.removeClass('c-header__is-active');
      }
    });

    // headerボタンクリック：指定の位置までスクロール（クロージャー使用）
    for (let i=0; i < upperTitle.length; i++) {
      $(`#header${upperTitle[i]}`).on('click', (function() {
        let x = i;

        return function() {
          let headerHeight = $('#header').innerHeight(); //innerHeight()は、paddingも含めた高さ

          $bodyAndHtml.animate({scrollTop: $(`#${lowerTitle[x]}`).offset().top - headerHeight});
        }
      })());
    }

    // スクロールイベント
    $(window).scroll(function() {
      let windowHeight = $(window).height(),
          skilldDetailPosi = $('#skillsDetail').offset().top;

      scrollPosi = $(window).scrollTop();

      (function appearTitleText() {
        for (let i=0; i < lowerTitle.length; i++) {
          $(`#${lowerTitle[i]}TitleWord`).each(function() {
            let titleTextPosi = $(this).offset().top;

            if (scrollPosi > titleTextPosi - windowHeight + 100){
              $(this).addClass('slideInToDown'); // 速度：addClass、removeClass > .css()
            }
          });
        }
      })();

      (function apperAboutText() {
        $('.p-top-intro__infoTextBlock').each(function() {
          let aboutTextPosi = $(this).offset().top;

          if (scrollPosi > aboutTextPosi - windowHeight + 150){
            $(this).addClass('slideInToUp');
          }
        })
      })();

      (function appearLang() {
        let langArea = ['front', 'back', 'tools'];
        let frontDetailsPosi = $('#frontDetailList').offset().top,
            backDetailsPosi = $('#backDetailList').offset().top,
            toolsDetailsPosi = $('#toolsDetailList').offset().top;

        if (scrollPosi > frontDetailsPosi - windowHeight + 300){
          for (let i=0; i < 6; i++) {
            $(`#frontItemUnit${i+1}`).addClass('slideInToUp');
          }
          for (let i=0; i < 7; i++) {
            $(`#frontExtendGraph${i}`).each(function() {
              extend = $(this).data('extend');
              $(this).css({'width': extend * 20 + '%', 'opacity': '1'});
            });
          }
        }

        if (scrollPosi > backDetailsPosi - windowHeight + 300){
          for (let i=0; i < 6; i++) {
            $(`#backItemUnit${i+1}`).addClass('slideInToUp');
          }
          for (let i=0; i < 7; i++) {
            $(`#backExtendGraph${i}`).each(function() {
              extend = $(this).data('extend');
              $(this).css({'width': extend * 20 + '%', 'opacity': '1'});
            });
          }
        }

        if (scrollPosi > toolsDetailsPosi - windowHeight + 300){
          for (let i=0; i < 6; i++) {
            $(`#toolsItemUnit${i+1}`).addClass('slideInToUp');
          }
          for (let i=0; i < 7; i++) {
            $(`#toolsExtendGraph${i}`).each(function() {
              extend = $(this).data('extend');
              $(this).css({'width': extend * 20 + '%', 'opacity': '1'});
            });
          }
        }

        // for (let i=0; i < langArea.length; i++) {
        //   let x = i;

        //   if (scrollPosi > `${langArea[x]}`DetailsPosi - windowHeight + 300){
        //     return function() {
        //       for (let j=0; j < 6; j++) {
        //         $(`#${langArea[x]}ItemUnit${j+1}`).addClass('slideInToUp');
        //       }
        //       for (let k=0; k < 7; k++) {
        //         $(`#${langArea[x]}ExtendGraph${i}`).each(function() {
        //           extend = $(this).data('extend');
        //           $(this).css({'width': extend * 20 + '%', 'opacity': '1'});
        //         });
        //       }
        //     }
        //   }
        // }

        (function productionAddShadow() {
          $('.p-top-production__itemList__img').each(function() {
            let productsPosi = $(this).offset().top;

            if (scrollPosi > productsPosi - windowHeight + 200){
              $(this).addClass('productionAnim');
              $(this).addClass('productionSlideInToUp');
            }
          });
        })();
      })();
    });

    // production画像クリック→詳細表示
    for (let i=0; i < lowerTitle.length; i++) {
      $(`#productionItemList${i+1}`).on('click', function() {
        $(`#productionDetail${i+1}`).addClass('show');

        // if($(`#productionDetail${i+1}`).hasClass('show')) {
        //   $body.on('click', function() {
        //     $(`#productionDetail${i+1}`).removeClass('show');
        //   })
        // }
      });

      $(`#productionCrossIcon${i+1}`).on('click', function() {
        $(`#productionDetail${i+1}`).removeClass('show');
      });
    }

    // 問い合わせフォーム：バリデーション
    $("#contactForm").validate({
      rules: {
        lastName: {
          required: true, // 入力必須チェック
          rangelength: [1, 25],
        },
        firstName: {
          required: true, // 入力必須チェック
          rangelength: [1, 25],
        },
        email: {
          required: true, // 入力必須チェック
          email: true, // 形式チェック
        },
        message: {
          required: true // 入力必須チェック
        }
      },
      messages: {
        lastName: {
          required: "*苗字を入力してください",
        },
        firstName: {
          required: "*名前を入力してください",
        },
        email: {
          required: "*メールアドレスを入力してください",
          email: "*正しいメールアドレス形式で入力してください",
        },
        message: {
          required: "*メッセージを入力してください"
        }
      }
    });
  }
</script>
</body>
</html>